## 302 和 307 浏览器处理的差别

### ？ 状态码 302 和 307 对实体的影响，307 是相当于直接做转发而不对请求做任何处理吗？

1. get: 对于 get 请求，浏览器收到 302 和 307 时，处理是类似的，就是重新发起一个对 Location 首部 url 的 get 请求，原来请求中的 querystring 也会没有

2. post: 对于 post 请求，浏览器收到 302 时（chrome 和 firefox），会不按照规范，转而发起一个读 Location 首部 url 的 get 请求，原来的请求 body 也不会再发；而 307 则是对 Location 首部的 url 发起一个 post 请求，原来的请求 body 也会发出

### ？ oss 后台默认开启 gzip，是否还需要请求 HTTP 携带 gzip 相关首部？如果请求 HTTP 不携带 gzip 会有什么问题？

如果请求中没有 Accept-Encoding 头部，表示客户端没有特别偏好的内容编码，因此服务端可能会发送任何一种编码的内容，但是客户端却不一定能够正确处理该编码。

服务器用以下的规则来测试某一种内容编码是不是能够被接受的：

1. 如果请求中没有 Accept-Encoding 字段，则任何编码都被认为是客户端能接受的
2. 如果响应没有进行内容编码，则对于任何没有明确将 identity 排除的 Accept-Encoding 请求头（"identity;q=0" or "\*;q=0"），都认为是能够接受的
3. 如果响应的编码是 Accept-Encoding 中的一种，只要该编码在 Accept-Encoding 中没有被赋予 qvalue=0 的权重，则就是可接受的
4. 如果多种 Content-Encoding 都是能够被接受的，那么权重最高的编码方式是更被接受的（is preferred）

**x-content-type-options：nosniff，安全方面的一个首部，设置了之后，下面两种情况的请求将被阻止：请求类型是"style" 但是 MIME 类型不是 "text/css"；请求类型是"script" 但是 MIME 类型不是 JavaScript MIME 类型**

### ？Content-Length

内容编码是在传输前进行的，一般是为了对实体主体进行压缩

传输编码是在传输的过程中进行编码，在内容编码的基础上，可以继续对实体主体进行传输编码，使其可以分块传输，也可以不进行分块传输编码直接一次性进行完整传输

用来指明发送给接收方的消息主体的大小，即用十进制数字表示的八位元组的数目（Octet && Byte）。

标准中列出了一些情况，是不会发送 Content-Length 头的：

1. 消息中包含了 Transfer-Encoding 头
2. 响应状态码为 1XX 和 204 的情况下，不发
3. 2XX 的 Connect 请求
4. 其他的...

## 通信数据转发程序：代理、网关、隧道

- 代理

代理服务器的基本行为就是接收客户端发送的请求后转发给其他服务器。

代理不改变请求 URI，会直接发送给前方持有资源的目标服务器。每次通过代理服务器转发请求或响应时，会追加写入 Via 首部信息

1. 缓存代理：服务器会缓存请求的资源，下次请求时，直接返回缓存的资源，不再请求源服务器

2. 透明代理：转发请求或响应时，不对报文做任何加工的代理类型被称为透明代理

- 网关

网关的工作机制和代理十分相似，而网关能使通信线路上的服务器提供非 HTTP 协议服务。

- 隧道

隧道可按要求建立起一条与其他服务器的通信线路，届时使用 SSL 等加密手段进行通信。隧道的目的是确保客户端能与服务器进行安全的通信。
