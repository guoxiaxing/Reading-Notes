# 用单台虚拟主机实现多个域名

HTTP/1.1 规范允许一台 HTTP 服务器搭建多个 Web 站点

虚拟主机功能，可以实现物理上只有一台服务器，但是假想上有多台服务器。

当请求发送到服务器上的时候已经是 ip 地址的形式了

> 由于虚拟主机的存在，有一种情况就是在相同的 IP 地址下，由于虚拟主机可以寄存多个不同主机名和域名的 Web 网站，因此在发送 HTTP 请求时，必须在 Host 首部内完整指定主机名或域名的 URI。

# 通信数据转发程序：代理、网关、隧道

这些应用程序和服务器可以将请求转发给通信线路上的下一站服务器，并且能接收从那台服务器发送的响应再转发给客户端。

## 代理

代理是一种有转发功能的**应用程序**，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。

代理服务器的基本行为就是接收客户端发送的请求后转发给其他服务器。代理不改变请求 URI，会直接发送给前方持有资源的目标服务器。

持有资源实体的服务器被称为源服务器。从源服务器返回的响应经过代理服务器后再传给客户端。

每次通过代理服务器转发请求或响应时，会追加写入 Via 首部信息。转发时，需要附加 Via 首部字段以标记出经过的主机信息。

代理有多种使用方法，按两种基准分类。一种是是否使用缓存，另一种是是否会修改报文。

### 缓存代理

代理转发响应时，缓存代理（Caching Proxy）会预先将资源的副本（缓存）保存在代理服务器上。再次请求时，就不需要请求原有服务器，直接将代理保存的缓存的资源作为响应返回

### 透明代理

转发请求或响应时，不对报文做任何加工的代理类型被称为透明代理（Transparent Proxy）。反之，对报文内容进行加工的代理被称为非透明代理。

## 网关

网关是转发其他服务器通信数据的**服务器**，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。

网关的工作机制和代理十分相似。而网关能使通信线路上的服务器提供非 HTTP 协议服务。

## 隧道

隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。

隧道可按要求建立起一条与其他服务器的通信线路。

隧道的目的是确保客户端能与服务器进行安全的通信。

隧道本身不会去解析 HTTP 请求。也就是说，请求保持原样中转给之后的服务器。隧道会在通信双方断开连接时结束。

# 保存资源的缓存

缓存是指代理服务器或客户端本地磁盘内保存的资源副本。利用缓存可以减少对源服务器的访问，加快请求时间（缓存服务器也是代理服务器）

缓存服务器的优势在于利用缓存可避免多次从源服务器转发资源。

## 缓存的有效期限

缓存失效，缓存服务器将会再次从源服务器上获取“新”资源。

## 客户端缓存

浏览器的本地缓存
